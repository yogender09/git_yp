A. UTP
3.1.1 Basic RSVP state replication to standby.  pass with recommendations for revising UTP
3.1.2 State timeouts on the standby.    pass
3.1.3 RSVP state is preserved across NSR switchovers.   pass (tracefile logs not compared yet...)
3.2.1 RSVP NSR switchover when DUT is the LSP egress point.     pass
3.3.1 fast-reroute replication test     pass
3.3.2 Fast-reroute preservation across switchover.      pass (tracefile logs not compared yet...)
3.4.1 Refresh Reduction testing MISSING
3.4.2 Attribute change reflected to standby.    pass
3.4.3 Repeated switchover test. pass
3.4.4 Recovery from config differences  do not have special image
3.4.5 Switchover while paths are being setup.   MISSING
3.4.6 Delay in setting up new paths when standby comes up       MISSING
3.4.7 Standby RE deletes all of its state when master restarts. pass
3.4.8 Labels are not advertised before replicating it to standby.       pass



B. Testing with full routes from BGP
   Configured BGP such that R0 peers with "reflector" to receive full
   routes; OSPF is the IGP. R1 is as route reflector. RSVP fast reroute is
   turned on. RSVP tracing is turned on. MPLS LSPs are established between
   the following nodes:

   In/Egress  Num LSPs
   ---------  --------
   R0 to R3 : 5001
   R3 to R0 : 5001
   R0 to R4 :    1
   R4 to R0 :    1
   R0 to R2 :    1
   R2 to R0 :    1

With the above configuration (no traffic, no NSR switchovers), LSPs
continually go down and back up.  From among the above LSPs I would see
roughly 10 LSPs down at any given time, though it seems like different
ones were flapping.

However, when RSVP refresh reduction is enabled, the flapping problem goes
away.


C. Reprogramming of label routes after NSR.  
   After NSR switchover, we found that RPD on the new master is
   reprogramming label routes to the kernel.  These routes have the same
   nhid as were programmed originally.  See PR 416406 for more info.

After NSR, rtsockmon -t shows
[18:54:07] rpd      P    route      change  mpls 0 tid=0 plen=52 type=user flags=0x8000 nh=ucst nhflags=0x5 nhidx=551 altfwdnhidx=0 filtidx=0
[18:54:07] rpd      P    route      change  mpls 0 tid=0 plen=56 type=user flags=0x8000 nh=ucst nhflags=0x5 nhidx=552 altfwdnhidx=0 filtidx=0
[18:54:07] rpd      P    route      change  mpls 0 tid=0 plen=52 type=user flags=0x8000 nh=ucst nhflags=0x5 nhidx=553 altfwdnhidx=0 filtidx=0
[18:54:07] rpd      P    route      change  mpls 0 tid=0 plen=56 type=user flags=0x8000 nh=ucst nhflags=0x5 nhidx=554 altfwdnhidx=0 filtidx=0



D. Test automation

1. The JT scripts in /homes/benchen/projects/rsvpnsr/scripts are setup
   scripts for a 3-router setup and a 5-router setup.

2. This script sets up LSPs for manual testing:
   /homes/benchen/pub/setupLSPs

3. This script performs repeated RE switchovers:
   /homes/benchen/pub/re-switch.pl
